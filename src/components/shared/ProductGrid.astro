---
/**
 * ProductGrid.astro â€“ FIXED (Dashboard + Login korrekt)
 * -----------------------------------------------------
 * âœ… Dashboard: rendert injizierte Upsell-Produkte
 * âœ… Login: nutzt interne Teaser-Texte als Fallback
 * âŒ Kein Redirect
 * âŒ Kein i18n hier
 */

import ProductCard from "./ProductCard.astro";

// URL â†’ Sprache
const currentPath = Astro.url.pathname.toLowerCase();
const detectedLang = currentPath.includes("/en") ? "en" : "de";

// Props
const {
  products = null,      // ðŸ‘‰ Dashboard Ã¼bergibt hier Upsell-Produkte
  variant = "teaser",   // teaser | upsell (nur relevant fÃ¼r Fallback)
  lang = detectedLang,
  compact = false,
} = Astro.props;

/* ------------------------------------------------------------------ */
/* ðŸ§© Fallback: Teaser-Texte (NUR Login / Landing)                     */
/* ------------------------------------------------------------------ */
const teaserProducts = {
  de: [
    {
      title: "SmartProfile",
      label: "Bald verfÃ¼gbar",
      text:
        "Erstelle Dein professionelles Profil mit nur wenigen Klicks â€“ perfekt fÃ¼r Freelancer, Coaches und Unternehmer.",
      gradient: "from-[#4E6BFF] to-[#657AFF]",
      glow: "hover:shadow-[0_0_30px_#4E6BFF80]",
      action: null,
    },
    {
      title: "SmartPage",
      label: "Bald verfÃ¼gbar",
      text:
        "Erstelle beeindruckende, konversionsoptimierte Seiten in Minuten â€“ einfach, schnell und professionell.",
      gradient: "from-[#F5B400] to-[#E47E00]",
      glow: "hover:shadow-[0_0_30px_#F5B40080]",
      action: null,
    },
    {
      title: "SmartDomain",
      label: "Bald verfÃ¼gbar",
      text:
        "Sichere Dir Deine eigene Domain direkt in SmartPages â€“ professionell, einfach und DSGVO-konform.",
      gradient: "from-[#8B5CFF] to-[#A076FF]",
      glow: "hover:shadow-[0_0_30px_#8B5CFF80]",
      action: null,
    },
  ],
  en: [
    {
      title: "SmartProfile",
      label: "Coming soon",
      text:
        "Create your professional profile in just a few clicks â€“ ideal for freelancers, coaches, and entrepreneurs.",
      gradient: "from-[#4E6BFF] to-[#657AFF]",
      glow: "hover:shadow-[0_0_30px_#4E6BFF80]",
      action: null,
    },
    {
      title: "SmartPage",
      label: "Coming soon",
      text:
        "Build stunning, conversion-optimized pages in minutes â€“ simple, fast, and professional.",
      gradient: "from-[#F5B400] to-[#E47E00]",
      glow: "hover:shadow-[0_0_30px_#F5B40080]",
      action: null,
    },
    {
      title: "SmartDomain",
      label: "Coming soon",
      text:
        "Secure your own domain directly within SmartPages â€“ professional, easy, and GDPR-compliant.",
      gradient: "from-[#8B5CFF] to-[#A076FF]",
      glow: "hover:shadow-[0_0_30px_#8B5CFF80]",
      action: null,
    },
  ],
};

/* ------------------------------------------------------------------ */
/* âœ… ENTSCHEIDUNG: injected > fallback                                */
/* ------------------------------------------------------------------ */
const items =
  Array.isArray(products) && products.length > 0
    ? products
    : teaserProducts[lang];
---

<section
  class={`${
    compact
      ? "w-full mx-auto grid grid-cols-1 md:grid-cols-3 gap-5 items-stretch justify-items-center"
      : "max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-6 px-4 md:px-6 py-4 md:py-5 items-stretch justify-items-center"
  }`}
>
  {items.map((p) => (
    <div class="w-full flex justify-center">
      <ProductCard
        title={p.title}
        label={p.label}
        text={p.text}
        gradient={p.gradient}
        glow={p.glow}
        action={p.action}
      />
    </div>
  ))}
</section>
