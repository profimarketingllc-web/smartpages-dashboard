---
/**
 * ProductGrid.astro ‚Äì stabile Version
 * -----------------------------------
 * ‚úî Teaser-Texte bleiben hier
 * ‚úî Upsell kommt IMMER √ºber Props
 * ‚úî Kein null / undefined mehr
 * ‚úî Astro-Compiler-sicher
 */

import ProductCard from "./ProductCard.astro";

// URL-basierte Sprach-Erkennung (nur Fallback)
const pathname = Astro.url.pathname.toLowerCase();
const detectedLang = pathname.includes("/en/") ? "en" : "de";

// Props
const {
  products = [],        // ‚ùó WICHTIG: niemals null
  variant = "teaser",   // teaser | upsell
  lang = detectedLang,
  compact = false,
} = Astro.props;

// ---------------- TEASER TEXTE (bleiben hier!) ----------------
const teaserProducts = {
  de: [
    {
      title: "SmartProfile",
      label: "Bald verf√ºgbar",
      text: "Erstelle Dein professionelles Profil mit nur wenigen Klicks ‚Äì perfekt f√ºr Freelancer, Coaches und Unternehmer.",
      gradient: "from-[#4E6BFF] to-[#657AFF]",
      glow: "hover:shadow-[0_0_30px_#4E6BFF80]",
      action: null,
    },
    {
      title: "SmartPage",
      label: "Bald verf√ºgbar",
      text: "Erstelle beeindruckende, konversionsoptimierte Seiten in Minuten ‚Äì einfach, schnell und professionell.",
      gradient: "from-[#F5B400] to-[#E47E00]",
      glow: "hover:shadow-[0_0_30px_#F5B40080]",
      action: null,
    },
    {
      title: "SmartDomain",
      label: "Bald verf√ºgbar",
      text: "Sichere Dir Deine eigene Domain direkt in SmartPages ‚Äì professionell, einfach und DSGVO-konform.",
      gradient: "from-[#8B5CFF] to-[#A076FF]",
      glow: "hover:shadow-[0_0_30px_#8B5CFF80]",
      action: null,
    },
  ],
  en: [
    {
      title: "SmartProfile",
      label: "Coming soon",
      text: "Create your professional profile in just a few clicks ‚Äì ideal for freelancers, coaches, and entrepreneurs.",
      gradient: "from-[#4E6BFF] to-[#657AFF]",
      glow: "hover:shadow-[0_0_30px_#4E6BFF80]",
      action: null,
    },
    {
      title: "SmartPage",
      label: "Coming soon",
      text: "Build stunning, conversion-optimized pages in minutes ‚Äì simple, fast, and professional.",
      gradient: "from-[#F5B400] to-[#E47E00]",
      glow: "hover:shadow-[0_0_30px_#F5B40080]",
      action: null,
    },
    {
      title: "SmartDomain",
      label: "Coming soon",
      text: "Secure your own domain directly within SmartPages ‚Äì professional, easy, and GDPR-compliant.",
      gradient: "from-[#8B5CFF] to-[#A076FF]",
      glow: "hover:shadow-[0_0_30px_#8B5CFF80]",
      action: null,
    },
  ],
};

// ---------------- PRODUKTE AUSW√ÑHLEN ----------------
const items =
  variant === "upsell"
    ? products                 // üîê kommt IMMER vom Wrapper
    : teaserProducts[lang] ?? teaserProducts.de;
---

<section
  class={`${
    compact
      ? "w-full mx-auto grid grid-cols-1 md:grid-cols-3 gap-5 items-stretch"
      : "max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-6 px-4 md:px-6 py-4 md:py-5 items-stretch"
  } animate-fadeIn`}
>
  {items.map((p) => (
    <div class="w-full flex justify-center">
      <ProductCard {...p} />
    </div>
  ))}
</section>

<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(12px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fadeIn {
    animation: fadeIn 0.5s ease-out both;
  }
</style>
