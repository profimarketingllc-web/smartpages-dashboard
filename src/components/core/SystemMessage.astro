---
/**
 * ğŸŒ SystemMessage.astro â€“ Middleware-fÃ¤hige, personalisierte Statusanzeige
 * ------------------------------------------------------------------------
 * âœ… Mehrsprachig (Ã¼ber Middleware oder URL)
 * âœ… Automatische Personalisierung Ã¼ber {{name}} (z. B. â€Willkommen, Martin ğŸ‘‹â€œ)
 * âœ… Farb- & Gradient-Logik pro Typ (info, success, warning, error)
 * âœ… Kompatibel mit SSR + Astro.locals
 * âœ… Responsive: zentriert auf kleinen Screens, rechtsbÃ¼ndig auf groÃŸen
 */

import { t } from "~/utils/i18n";

// ğŸ§© Props (mit sicheren Fallbacks)
const {
  lang = Astro.locals?.lang || (Astro.url.pathname.toLowerCase().includes("/en/") ? "en" : "de"),
  message = null,           // Optional: custom message von auÃŸen
  type = "info",            // info | success | warning | error
  userName = null,          // Optional: fÃ¼r personalisierte GrÃ¼ÃŸe
} = Astro.props;

// ğŸ§  Textlogik
let finalMessage;

// 1ï¸âƒ£ Wenn custom message Ã¼bergeben wurde â†’ direkt anzeigen
if (message) {
  finalMessage = message;
}
// 2ï¸âƒ£ Standardtext aus i18n.ts, automatisch mit Platzhalter ersetzt
else {
  finalMessage = t(lang, type, "system", { name: userName || "" });
}

// ğŸ¨ Farb- & Glow-Definitionen
const styleMap = {
  info: {
    gradient: "from-[#4E6BFF] to-[#657AFF]",
    glow: "hover:shadow-[0_0_20px_rgba(78,107,255,0.4)]",
  },
  success: {
    gradient: "from-[#3CB371] to-[#2E8B57]",
    glow: "hover:shadow-[0_0_20px_rgba(60,179,113,0.4)]",
  },
  warning: {
    gradient: "from-[#F5B400] to-[#E47E00]",
    glow: "hover:shadow-[0_0_20px_rgba(245,180,0,0.4)]",
  },
  error: {
    gradient: "from-[#E14D4D] to-[#B83535]",
    glow: "hover:shadow-[0_0_20px_rgba(225,77,77,0.4)]",
  },
}[type];
---

<!-- ğŸ§± Layout -->
<div class="system-message-container relative flex flex-col justify-center">
  <div
    class={`relative flex flex-col justify-center p-5 rounded-2xl shadow-lg border border-white/20 bg-gradient-to-br ${styleMap.gradient} text-white transition-all duration-300 ${styleMap.glow}`}
  >
    <p class="text-sm leading-relaxed text-white/90 text-center font-medium">
      {finalMessage}
    </p>
  </div>
</div>

<!-- ğŸ’… Style bleibt identisch, aber zentriert besser auf mobilen GerÃ¤ten -->
<style>
  .system-message {
    max-width: 420px;
    margin-left: auto;
    margin-right: 0;
    position: relative;
  }

  /* ğŸ“± Zentriert auf kleinen & mittleren Screens */
  @media (max-width: 1024px) {
    .system-message-container {
      display: flex;
      justify-content: center !important;
      align-items: center !important;
      margin: 1rem auto 0 auto !important;
      width: 100%;
    }

    .system-message {
      margin: 0 auto 1rem auto;
      display: flex;
      justify-content: center;
      max-width: 90%;
    }
  }
</style>
