---
import PageLayout from "~/layouts/PageLayout.astro";
import DashboardCardWide from "~/components/shared/DashboardCardWide.astro";
import ProductGrid from "~/components/shared/ProductGrid.astro";
import SystemMessage from "~/components/pages/dashboard/astro/SystemMessage.astro";

import CustomerCard from "~/components/pages/dashboard/solid/CustomerCard.jsx";
import ImprintCard from "~/components/pages/dashboard/solid/ImprintCard.jsx";
import PrivacyCard from "~/components/pages/dashboard/solid/PrivacyCard.jsx";

import dashboardI18n from "~/utils/i18n/dashboard";

// âš ï¸ Fallback, wird nach Hydration ersetzt
const lang = "de";
const tDashboard = dashboardI18n[lang];

const upsellProducts = Object.values(tDashboard.upsell).map((p) => ({
  title: p.title,
  text: p.text,
  action: "#",
}));
---

<PageLayout sidebar header>
  <main class="max-w-6xl mx-auto px-4 mt-6 mb-20">

    <DashboardCardWide>
      <CustomerCard client:only="solid-js" />
    </DashboardCardWide>

    <SystemMessage />

    <DashboardCardWide>
      <ImprintCard client:only="solid-js" />
    </DashboardCardWide>

    <DashboardCardWide>
      <PrivacyCard client:only="solid-js" />
    </DashboardCardWide>

    <ProductGrid products={upsellProducts} />
  </main>
</PageLayout>

<!-- ðŸŒ i18n-Hydration -->
<script>
  (function () {
    const user = window.SMARTPAGES_USER;
    if (!user || !user.language) return;

    document.documentElement.lang = user.language;
  })();
</script>
