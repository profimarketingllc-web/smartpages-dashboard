---
export const prerender = false;

import PageLayout from "~/layouts/PageLayout.astro";
import DashboardCardWide from "~/components/shared/DashboardCardWide.astro";
import CustomerCard from "~/components/pages/dashboard/solid/CustomerCard.jsx";
import ImprintCard from "~/components/pages/dashboard/solid/ImprintCard.jsx";
import PrivacyCard from "~/components/pages/dashboard/solid/PrivacyCard.jsx";
import ProductGrid from "~/components/shared/ProductGrid.astro";
import SystemMessage from "~/components/pages/dashboard/astro/SystemMessage.astro";

import dashboardI18n from "~/utils/i18n/dashboard";

const lang = Astro.locals.language || "de";
const user = Astro.locals.user || null;

const tDashboard = dashboardI18n[lang];

const upsellProducts = Object.values(tDashboard.upsell).map((p) => ({
  title: p.title,
  text: p.text,
  action: "#",
}));
---

<PageLayout title={tDashboard.page.title} sidebar header lang={lang}>
  <main class="max-w-6xl mx-auto px-4 mt-6 mb-20">

    {user ? (
      <>
        <DashboardCardWide>
          <CustomerCard client:only="solid-js" lang={lang} />
        </DashboardCardWide>

        <SystemMessage lang={lang} user={user} />

        <DashboardCardWide>
          <ImprintCard client:only="solid-js" lang={lang} />
        </DashboardCardWide>

        <DashboardCardWide>
          <PrivacyCard client:only="solid-js" lang={lang} />
        </DashboardCardWide>
      </>
    ) : (
      <div class="text-center text-gray-500 py-20">
        Bitte melde dich an, um dein Dashboard zu sehen.
      </div>
    )}

    <ProductGrid products={upsellProducts} />
  </main>
</PageLayout>
