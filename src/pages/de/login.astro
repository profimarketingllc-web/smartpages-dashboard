---
import SmartHeader from "../../components/SmartHeader.astro";
import "~/styles/global.css";
---

<head>
  <title>SmartPages Login</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="/favicon.ico?v=2" type="image/x-icon" />
</head>

<body class="bg-[#f9fafb] text-gray-800">
  <header class="sticky top-0 z-50 shadow-md">
    <SmartHeader />
  </header>

  <!-- HERO -->
  <section class="max-w-6xl mx-auto mt-12 px-6 grid md:grid-cols-2 gap-8">
    <!-- LEFT -->
    <div class="bg-white/80 shadow-xl rounded-2xl p-8 backdrop-blur-sm border border-gray-100 hover:shadow-2xl transition">
      <h2 class="text-3xl font-bold text-[#F5B400] mb-4">Willkommen bei SmartPages</h2>
      <p class="mb-4">Mit <strong>SmartPages</strong> startest Du in nur wenigen Minuten Dein eigenes digitales Zuhause – ohne technisches Wissen oder komplizierte Einrichtung. Alles wird sicher in <strong>Europa</strong> gehostet und ist vollständig <strong>DSGVO-konform</strong>.</p>
      <p class="mb-4">Wenn Deine Zielgruppe oder Kunden in der Europäischen Union sitzen, ist Datenschutz nach der DSGVO keine Option – sondern Pflicht. SmartPages hilft Dir, diese Anforderungen mühelos zu erfüllen, während Du gleichzeitig Vertrauen und Markenstärke aufbaust.</p>
      <p>Gib einfach Deine Basisdaten ein, und wir senden Dir Deinen <strong>persönlichen Magic-Link</strong> für den direkten Zugang zum Dashboard – ohne Passwort, ohne Tracking und ohne versteckte Datenerfassung.</p>
    </div>

    <!-- RIGHT -->
    <div class="bg-white/80 shadow-xl rounded-2xl p-8 backdrop-blur-sm border border-gray-100 hover:shadow-2xl transition">
      <form id="magicForm" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-600 mb-1">Vorname *</label>
          <input type="text" name="first_name" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#F5B400] outline-none transition" />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-600 mb-1">Nachname</label>
          <input type="text" name="last_name" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#F5B400] outline-none transition" />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-600 mb-1">E-Mail *</label>
          <input type="email" name="email" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#F5B400] outline-none transition" />
        </div>

        <div class="flex items-center gap-2">
          <input type="checkbox" id="is_business" name="is_business" class="accent-[#F5B400]" />
          <label for="is_business" class="text-sm text-gray-600">Das ist ein Firmenkonto (Business)</label>
        </div>

        <div id="company_field" class="hidden">
          <label class="block text-sm font-medium text-gray-600 mb-1">Firmenname</label>
          <input type="text" name="company_name" class="w-full border border-gray-300 rounded-lg px-3 py-2" />
        </div>

        <button type="submit" class="w-full bg-gradient-to-r from-[#F5B400] to-[#f59e0b] text-white font-semibold py-2 rounded-lg shadow-lg hover:shadow-amber-300/40 transition-all">
          Magic-Link senden
        </button>
      </form>
    </div>
  </section>

  <!-- PRODUKT-KACHELN -->
  <section class="max-w-6xl mx-auto mt-16 grid md:grid-cols-3 gap-8 px-6">
    <div class="relative bg-gradient-to-r from-[#6366f1] to-[#8b5cf6] text-white p-6 rounded-2xl shadow-xl hover:shadow-indigo-400/30 transition-all">
      <span class="absolute top-3 left-3 bg-white/20 border border-white/40 text-white text-xs px-3 py-1 rounded-full backdrop-blur-md">DEMNÄCHST</span>
      <h3 class="text-xl font-semibold mb-2">SmartProfile</h3>
      <p class="text-sm opacity-90">Dein persönliches Online-Profil – der perfekte Startpunkt für Deine digitale Präsenz.</p>
    </div>

    <div class="relative bg-gradient-to-r from-[#F5B400] to-[#f59e0b] text-white p-6 rounded-2xl shadow-xl hover:shadow-amber-300/40 transition-all">
      <span class="absolute top-3 left-3 bg-white/20 border border-white/40 text-white text-xs px-3 py-1 rounded-full backdrop-blur-md">DEMNÄCHST</span>
      <h3 class="text-xl font-semibold mb-2">SmartPage</h3>
      <p class="text-sm opacity-90">Erstelle beeindruckende Seiten mit nur wenigen Klicks – ganz ohne Technikkenntnisse.</p>
    </div>

    <div class="relative bg-gradient-to-r from-[#8b5cf6] to-[#6366f1] text-white p-6 rounded-2xl shadow-xl hover:shadow-indigo-400/30 transition-all">
      <span class="absolute top-3 left-3 bg-white/20 border border-white/40 text-white text-xs px-3 py-1 rounded-full backdrop-blur-md">DEMNÄCHST</span>
      <h3 class="text-xl font-semibold mb-2">SmartDomain</h3>
      <p class="text-sm opacity-90">Sichere Dir Deine eigene Domain und präsentiere Deine Marke professionell.</p>
    </div>
  </section>

  <footer class="mt-16 text-center text-sm text-gray-500 py-6 border-t">
    © 2025 SmartPages · Profi Marketing LLC · DSGVO-konform in Europa gehostet
  </footer>

  <script>
    const API_URL = "https://api.smartpages.online/api/auth/start";
    const form = document.getElementById("magicForm");
    const businessCheckbox = document.getElementById("is_business");
    const companyField = document.getElementById("company_field");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const data = {
        first_name: form.first_name.value.trim(),
        last_name: form.last_name.value.trim(),
        email: form.email.value.trim(),
        company_name: form.company_name?.value.trim() || "",
        is_business: form.is_business.checked,
      };

      try {
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data),
        });
        const result = await res.json();

        if (result.ok) {
          alert("✅ Magic-Link gesendet! Bitte prüfe Dein Postfach.");
          form.reset();
        } else {
          alert("❌ Fehler beim Versand. Bitte überprüfe Deine Angaben.");
        }
      } catch {
        alert("⚠️ Netzwerkfehler – bitte versuche es erneut.");
      }
    });

    businessCheckbox.addEventListener("change", (e) => {
      companyField.classList.toggle("hidden", !e.target.checked);
    });
  </script>
</body>
