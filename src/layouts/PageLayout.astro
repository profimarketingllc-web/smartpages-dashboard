---
import "~/styles/global.css";
import SmartHeader from "~/components/core/SmartHeader.astro";
import SmartSidebar from "~/components/core/SmartSidebar.astro";

/* ðŸ”§ Erweiterte Props fÃ¼r flexible Steuerung:
   - sidebar: zeigt die Navigationsleiste an (Standard: true)
   - header: zeigt den Header an (Standard: true)
   - sticky: Header bleibt oben fixiert (Standard: true)
   - headerOffset: legt oberen Abstand fest ("default" oder "compact")
   - lang: Sprachcode (Standard: 'de')
   - title: Seitentitel (Standard: "SmartPages")
*/
const {
  sidebar = true,
  header = true,
  sticky = true,
  headerOffset = "default",
  lang = "de",
  title = "SmartPages",
} = Astro.props;

// ðŸ§  Dynamische CSS-Klassen
const headerOffsetClass = headerOffset === "compact" ? "mt-6" : "mt-12";
const stickyClass = sticky ? "sticky top-0 z-50" : "";
---

<html lang={lang} class="h-full bg-smart-surface">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title || "SmartPages"}</title>

    <!-- ðŸŒ Meta + SEO -->
    <meta name="robots" content="noindex, nofollow" />
    <meta
      name="description"
      content="SmartPages Dashboard â€” privacy-first and GDPR compliant."
    />
    <meta name="theme-color" content="#1E2A45" />

    <!-- ðŸ§© Favicon & Branding -->
    <link rel="icon" href="/favicon.ico?v=2" type="image/x-icon" />
    <link rel="shortcut icon" href="/favicon.ico?v=2" type="image/x-icon" />
    <link rel="apple-touch-icon" sizes="192x192" href="/favicon-192.png?v=2" />
    <meta name="theme-color" content="#1e293b" />

    <!-- ðŸŒ€ Global Styles -->
    <link rel="stylesheet" href="/src/styles/global.css" />
  </head>

  <body
    class="min-h-screen flex font-sans text-smart-text bg-smart-surface antialiased relative"
  >
    {
      sidebar ? (
        <>
          <!-- ðŸ§­ Sidebar -->
          <SmartSidebar client:load collapsible />

          <!-- Hauptbereich -->
          <div
            class="flex-1 flex flex-col transition-all duration-300 md:ml-64 bg-white"
          >
            {header && (
              <div class={stickyClass}>
                <SmartHeader client:load />
              </div>
            )}

            <!-- ðŸ§± Hauptinhalt -->
            <main class={`flex-1 p-4 md:p-6 ${header ? headerOffsetClass : ""}`}>
              <slot />
            </main>

            <!-- âš™ï¸ Footer -->
            <footer
              class="text-center text-sm text-gray-500 mt-auto py-6 border-t border-gray-200"
            >
              Â© {new Date().getFullYear()} SmartPages Â· Hosted in Europe Â· GDPR-compliant
            </footer>
          </div>
        </>
      ) : (
        <!-- ðŸª¶ Layout ohne Sidebar -->
        <div class="flex-1 flex flex-col min-h-screen bg-white text-smart-text">
          {header && (
            <div class={stickyClass}>
              <SmartHeader client:load />
            </div>
          )}

          <!-- Inhalt -->
          <main class={`flex-1 p-4 md:p-6 ${header ? headerOffsetClass : ""}`}>
            <slot />
          </main>

          <!-- Footer -->
          <footer
            class="text-center text-sm text-gray-500 mt-auto py-6 border-t border-gray-200"
          >
            Â© {new Date().getFullYear()} SmartPages Â· Hosted in Europe Â· GDPR-compliant
          </footer>
        </div>
      )
    }

    <!-- ðŸ’¬ Floating Support Button -->
    <button
      id="supportButton"
      class="fixed bottom-6 right-6 bg-gradient-to-r from-[#4E6BFF] to-[#657AFF] text-white rounded-full shadow-xl px-6 py-3 font-medium hover:opacity-90 transition-all"
    >
      ðŸ’¬ Nachricht an das Team
    </button>

    <script>
      const supportBtn = document.getElementById("supportButton");
      supportBtn?.addEventListener("click", () => {
        alert("Der Chatbot ist in dieser Beta-Version noch nicht aktiv. Bitte kontaktiere uns per support@smartpages.online.");
      });
    </script>
  </body>
</html>
